# Linux 系统监控与安全工具集

本目录包含了一系列用于Linux系统监控和安全管理的Shell脚本工具。这些工具可以帮助系统管理员进行网络监控、进程分析和IP封禁管理。

## 工具列表

### 1. blockIP.sh - IP封禁管理脚本

**更新时间**: 2025-07-14 (今日更新)

**脚本特点**:
- 支持iptables和firewall两种防火墙工具
- 自动检测可用的防火墙工具
- 支持单个IP和批量IP操作
- 完整的备份和恢复功能
- 预览模式，可查看将要执行的命令
- 详细的日志记录功能
- 严格的错误处理机制

**主要功能**:
- IP地址封禁和解封
- 批量处理IP列表文件
- 列出当前被封禁的IP
- 检查指定IP的封禁状态
- 防火墙规则备份和恢复
- 显示防火墙状态

**使用说明**:
```bash
# 基本用法
./blockIP.sh [选项] <IP地址|IP文件>

# 常用选项
-b, --block         封禁IP地址(默认操作)
-u, --unblock       解封IP地址
-t, --tool TOOL     指定防火墙工具: iptables, firewall, auto(默认)
-f, --file FILE     从文件批量处理IP地址
-l, --list          列出当前封禁的IP地址
-c, --check IP      检查指定IP是否被封禁
-s, --status        显示防火墙状态
--backup            备份当前防火墙规则
--restore FILE      从备份文件恢复防火墙规则
--show-run          预览模式，仅显示命令不执行

# 使用示例
./blockIP.sh 192.168.1.100                    # 封禁单个IP
./blockIP.sh -u 192.168.1.100                 # 解封单个IP
./blockIP.sh -f ip_list.txt                   # 批量封禁IP
./blockIP.sh -l                               # 列出被封禁的IP
./blockIP.sh --backup                         # 备份防火墙规则
./blockIP.sh --show-run -f ip_list.txt        # 预览批量操作
```

**注意事项**:
- 需要root权限运行
- 脚本会自动备份配置，但建议手动备份重要配置
- 支持IPv4地址格式验证
- 日志文件默认保存在当前目录的outBlockIP.log

---

### 2. monitorInter.sh - 网络接口流量监控脚本

**更新时间**: 2025-07-08

**脚本特点**:
- 实时监控网络接口流量
- 支持单次检测和持续监控模式
- 自动格式化字节数显示(B/KB/MB/GB)
- 显示详细的接口信息
- 计算实时传输速率
- 友好的用户界面和颜色输出

**主要功能**:
- 监控指定网络接口的发送和接收流量
- 显示数据包数量和字节数统计
- 计算实时传输速率
- 列出所有可用的网络接口
- 显示接口状态、IP地址和MAC地址

**使用说明**:
```bash
# 基本用法
./monitorInter.sh <网络接口> [选项]

# 常用选项
-c, --continuous    持续监控模式(默认为单次检测)
-i, --interval N    监控间隔时间(秒,默认1秒)
-l, --list          列出所有可用的网络接口
-h, --help          显示帮助信息

# 使用示例
./monitorInter.sh eth0                        # 单次检测eth0接口
./monitorInter.sh eth0 -c                     # 持续监控eth0接口
./monitorInter.sh eth0 -c -i 5                # 每5秒刷新一次
./monitorInter.sh -l                          # 列出所有网络接口
```

**输出信息**:
- 接口基本信息(名称、状态、IP地址、MAC地址)
- 流量统计(发送/接收的数据包数和字节数)
- 实时传输速率(B/s, KB/s, MB/s等)
- 格式化的易读显示

---

### 3. monitorPs2Ip.sh - IP通信进程监控脚本

**更新时间**: 2025-07-02

**脚本特点**:
- 检测与指定IP通信的所有进程
- 支持多种网络检测工具(lsof, netstat, ss)
- 自动检测可用工具并选择最佳方案
- 支持TCP、UDP和ICMP协议监控
- 显示详细的连接信息和进程信息
- 支持持续监控模式

**主要功能**:
- 检测与目标IP建立连接的进程
- 显示进程名、PID、用户、协议类型
- 显示本地地址和远程地址信息
- 检测ping等ICMP连接
- 支持单次检测和持续监控

**使用说明**:
```bash
# 基本用法
./monitorPs2Ip.sh <IP地址> [选项]

# 常用选项
-c, --continuous    持续监控模式(按Ctrl+C停止)
-i, --interval N    持续监控时间间隔(秒，默认5秒)
-h, --help          显示帮助信息

# 使用示例
./monitorPs2Ip.sh 192.168.1.100               # 单次检测
./monitorPs2Ip.sh 192.168.1.100 -c            # 持续监控
./monitorPs2Ip.sh 192.168.1.100 -c -i 10      # 每10秒监控一次
```

**输出信息**:
- 进程名称和PID
- 运行用户
- 协议类型(TCP/UDP/ICMP)
- 本地地址和端口
- 远程地址和端口
- 连接状态信息

**依赖工具**:
脚本会自动检测并使用以下工具之一:
- lsof (推荐，功能最全面)
- ss (现代替代工具)
- netstat (传统工具)

---

## 系统要求

- Linux操作系统
- Bash shell环境
- 相应的系统权限(某些功能需要root权限)
- 网络监控工具(lsof/netstat/ss等)

## 安装和使用

1. 确保脚本具有执行权限:
```bash
chmod +x *.sh
```

2. 根据需要运行相应的脚本:
```bash
# 查看帮助信息
./scriptname.sh -h

# 执行具体功能
./scriptname.sh [参数]
```

## 注意事项

1. **权限要求**: blockIP.sh需要root权限运行
2. **备份建议**: 使用blockIP.sh前建议手动备份防火墙配置
3. **网络工具**: 确保系统安装了必要的网络监控工具
4. **IP格式**: 所有脚本都支持IPv4地址格式验证
5. **日志记录**: blockIP.sh会生成详细的操作日志

## 故障排除

- 如果遇到权限问题，请使用sudo运行脚本
- 如果网络监控工具不可用，请安装相应的软件包
- 查看脚本的帮助信息了解详细用法
- 检查日志文件获取错误信息

## 作者信息

- 作者: Sun977
- 项目: LinuxCheckShoot - 安全检测工具集
- 更新: 持续维护和功能增强

---

*本工具集旨在提供便捷的Linux系统监控和安全管理功能，请在了解脚本功能的前提下谨慎使用。*